# 完善注销流程与 UI 优化计划

您指出的非常准确。目前的 `deleteAccount` 仅在客户端删除了业务数据，但由于 Supabase 的安全策略，客户端 SDK 默认无法直接删除 `auth.users` 表中的账号，导致“账号未物理删除，仍可登录”。

为了实现**真正的账号注销**并优化 UI 体验，我建议采取以下方案：

## 1. UI 体验优化
*   **修改 `components/Settings.tsx`**:
    *   移除确认弹窗中“请输入 DELETE”的文案，仅保留双重确认（Double Confirm）逻辑。

## 2. 实现“物理删除账号” (Server-Side Deletion)
由于这是纯前端项目，我们需要利用 Supabase 的数据库函数 (RPC) 来绕过客户端权限限制。

*   **创建 SQL 脚本**:
    *   新增文件 `supabase_setup.sql`。
    *   编写一个 PostgreSQL 函数 `delete_user()`，使用 `security definer` 权限，允许用户**仅删除自己的账号** (`auth.users` 表)。
    *   *说明：这需要您在 Supabase 后台的 SQL Editor 中运行一次该脚本。*

*   **升级 `authService.ts`**:
    *   在 `deleteAccount` 方法中，保留现有的数据清理逻辑（双重保险）。
    *   在清理完数据后，增加调用 `supabase.rpc('delete_user')`。
    *   如果 RPC 调用失败（例如您还没运行 SQL），则回退到“仅退出登录”并提示用户。

## 3. 预期效果
1.  用户点击“注销账号” -> 确认风险 -> 确认操作。
2.  App 清空业务数据。
3.  App 请求 Supabase 数据库彻底删除该用户。
4.  用户被强制登出，且无法再用原账号登录（必须重新注册）。

这个方案既解决了 UI 的繁琐，也补齐了真正的注销能力。您同意这个技术路径吗？
